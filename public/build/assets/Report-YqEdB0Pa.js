import{_ as f}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{D as h,o as p,f as m,b as o,a as y}from"./app-XwlNAViC.js";function d(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function c(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function g(e,t){const n=d(e);return isNaN(t)?c(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function D(e,t){const n=d(e);if(isNaN(t))return c(e,NaN);if(!t)return n;const r=n.getDate(),a=c(e,n.getTime());a.setMonth(n.getMonth()+t+1,0);const s=a.getDate();return r>=s?a:(n.setFullYear(a.getFullYear(),a.getMonth(),r),n)}function l(e,t,n=[]){return n.length>=t?e(...n.slice(0,t).reverse()):(...r)=>l(e,t,n.concat(r))}function M(e,t){const n=t*7;return g(e,n)}function _(e,t){const n=d(e),r=d(t);return n.getTime()>r.getTime()}const u=l(_,2);function w(e,t){return D(e,-t)}const k=l(w,2);function v(e,t){return M(e,-t)}const N=l(v,2),T={data:()=>({columns:[{label:"DATE",field:"read_at",type:"date",dateInputFormat:"yyyy-MM-dd HH:mm:ss",dateOutputFormat:"eee, d-MMM-yyyy",tdClass:"text-start",thClass:"text-start"},{label:"TIME",field:"read_at",type:"date",dateInputFormat:"yyyy-MM-dd HH:mm:ss",dateOutputFormat:"h:mm:ss a",tdClass:"text-start",thClass:"text-start"},{label:"TYPE",field:"type"},{label:"READING",field:"reading",type:"number"}],readings:[],filter:[],report_type:"all"}),mounted(){axios.get("/api/v1/readings").then(e=>{this.readings=e.data.data,this.reset()})},methods:{print(){let e=this.report_type;fetch(`/api/v1/readings/download/${e}`,{method:"GET",headers:new Headers({Authorization:"Bearer "+localStorage.getItem("token")})}).then(t=>t.blob()).then(t=>{var n=new Date,r=`${n.getFullYear()}.${n.getMonth()}.${n.getDate()}-${e}.pdf`,a=window.URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=r,document.body.appendChild(s),s.click(),s.remove()})},reset(){this.filter=this.readings,this.report_type="all"},today(){this.filter=this.readings.filter(e=>new Date(e.read_at).toDateString()===new Date().toDateString()),this.report_type="today"},thisWeek(){let t=N(1,new Date);t.setHours(0),t.setMinutes(0),t.setSeconds(0),this.filter=this.readings.filter(n=>u(t,new Date(n.read_at))),this.report_type="week"},thisMonth(){let t=k(1,new Date);t.setHours(0),t.setMinutes(0),t.setSeconds(0),this.filter=this.readings.filter(n=>u(t,new Date(n.read_at))),this.report_type="month"},formatDate:e=>{const t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];let r=new Date(e);return`${t[r.getDay()]} ${r.getDate()}-${n[r.getMonth()]}-${r.getFullYear()}`},formatTime:e=>{let t=new Date(e);var n=t.getHours(),r=n%12||12,a=n<12||n===24?"AM":"PM";return`${r}:${t.getMinutes().toString().padStart(2,"0")} ${a}`},capitalize:e=>e?(e=e.toString(),e.toUpperCase()):""}},S={class:"container"},C={class:"row justify-content-center"},F={class:"col-md-8"},E={class:"card mb-2"},H={class:"card-header"},O={class:"btn-toolbar",role:"toolbar","aria-label":""},$={class:"card",ref:"report"};function W(e,t,n,r,a,s){const b=h("vue-good-table");return p(),m("div",S,[o("div",C,[o("div",F,[o("div",E,[o("div",H,[o("div",O,[o("button",{type:"button",class:"btn btn-sm btn-outline-dark me-1",onClick:t[0]||(t[0]=(...i)=>s.today&&s.today(...i))}," TODAY "),o("button",{type:"button",class:"btn btn-sm btn-outline-dark me-1",onClick:t[1]||(t[1]=(...i)=>s.thisWeek&&s.thisWeek(...i))}," WEEK "),o("button",{type:"button",class:"btn btn-sm btn-outline-dark me-1",onClick:t[2]||(t[2]=(...i)=>s.thisMonth&&s.thisMonth(...i))}," MONTH "),o("button",{type:"button",class:"btn btn-sm btn-outline-dark me-1",onClick:t[3]||(t[3]=(...i)=>s.reset&&s.reset(...i))}," RESET "),o("button",{type:"button",class:"btn btn-sm btn-outline-dark",onClick:t[4]||(t[4]=(...i)=>s.print&&s.print(...i))}," PRINT ")])])]),o("div",$,[y(b,{columns:e.columns,rows:e.filter,compactMode:!0,"sort-options":{enabled:!1},theme:"nocturnal",styleClass:"vgt-table striped"},null,8,["columns","rows"])],512)])])])}const I=f(T,[["render",W]]);export{I as default};
